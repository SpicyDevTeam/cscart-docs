******
4.17.1
******

==================================
Новая функциональность и улучшения
==================================

[+] Multi-Vendor: Модули: PayPal Commerce Platform: Добавлена информация по получению кода интеграции PayPal непосредственно в окне настройки способа оплаты.

[+] Multi-Vendor Plus: Модули: Общие товары для продавцов: Промо-акции и скидки: Добавлено отображение скидки с промоакции на каталог на витрине.

[+] Товары: Выбор объектов: Количество и продавец товара были добавлены в выбор товара.

[+] UI / UX: Languages: Был добавлен индикатор мультиязычных полей для некоторых страниц.

[+] Настройки: Внешний вид: Добавлен вариант "Номер телефона с выбором страны" для настройки "Допустимые номера телефонов".

[+] Центр обновлений: CS-Cart теперь проверяет данные из маркета модулей и предупреждает, если есть модули, которые еще несовместимы с новой версией CS-Cart.

[+] Центр обновлений: Добавлен фильтр для обновлений модулей по разработчику и статусу.

=========================================
Изменения в существующей функциональности
=========================================

[*] Multi-Vendor: Модули: Конфигуратор панели продавцов:  Группы пользователей: Привилегии: Теперь для входа как продавец из административной панели нужна привилегия "Продавцы: Редактирование". Она же позволяет редактировать панель продавца.

[*] Multi-Vendor: Продавцы: Языки: Добавлена возможность перевода наименования, города и адреса продавцов. Переводы отображаются на витрине и в email уведомлениях.

[*] WYSIWYG: Редактор TinyMCE обновлен до версии 4.7.10.

[*] Безопасность: Редактор файлов: Повышена безопасность загрузки файлов.

[*] Дизайн: Настройка формата для настроек блока языка была переименована.

[*] Multi-Vendor Plus: Модули: Общие товары для продавцов: Добавлено отображение старой цены товарного предложения при наличии промо-акции.

[*] Модули: Служба доставки — СДЭК: Тарифы доставки были обновлены в соответствии с документацией СДЭК.

[*] Модули: Соответствие GDPR (Общему регламенту по защите данных в ЕС): Всплывающая подсказка с условиями использования была заменена всплывающим окном.

[*] Модули: ЮKassa: Добавлен признак "payment_subject" в чеки оплаты и возврата.

[*] Оформление заказа: Поля профиля: Уведомления об обновлении профиля теперь приходят, когда профиль действительно был обновлен.

[*] Профили: Администраторы: Добавлены новые атрибуты администраторов на их списке: "главный администратор" и "главный администратор для витрины".

[*] Редактор тем: Шрифты Google теперь размещаются локально.

[*] Способы доставки: Тарифные зоны: Тарифная зона теперь отображается на вкладке проверки расчета тарифа.

[*] Способы доставки: Теперь, для отображения расчёта времени доставки, в первую очередь используется время, полученное от сервиса доставки.

[*] Центр помощи: Был увеличен отступ между блоками и перенесен заголовок блоков.

[*] Центр обновлений: Все названия обновлений модулей теперь приведены к стандарту: название модуля и номер версии.

[*] Центр обновлений: Стили Центра обновлений были обновлены.

[*] Центр обновлений: Улучшен механизм уведомлений о доступных обновлениях.

==================
Исправления ошибок
==================

[!] Add-ons: Соответствие GDPR (Общему регламенту по защите данных в ЕС): Некоторые JS скрипты не загружались, если в настройках "Согласие на файлы cookie" было выбрано "Не требуется". Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Вариации товаров: Вариации товара отображались не в наличии на странице быстрого просмотра товара. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Вариации товаров: Витрины: В некоторых случаях товар не отображался в списке товаров категории. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Опции товаров: Настройка "Быстрая покупка одного из предложений" некорректно работала с опциями товара. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Фильтры: Фильтр по цене не учитывал актуальную цену общего товара после оформления заказа. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Хиты продаж и товары со скидкой: На списке товаров со скидкой отображались предложения без скидок. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Общие товары для продавцов: При работе с общими товарами, в заказе, в некоторых случаях некорректно выполнялось распределение товаров по продавцам. Исправлено.

[!] Multi-Vendor: Модули: Оплата напрямую продавцам: Модуль мог вызывать PHP fatal error в сторонних темах и модулях. Исправлено.

[!] Multi-Vendor Ultimate: Email-уведомления: При отправке email-уведомлений не учитывалось, к какой витрине принадлежит администратор. Исправлено.

[!] Multi-Vendor Ultimate: Категории: Витрины: На странице редактирования категории при выбранной витрине в поле "Расположение" могли отображаться категории других витрин. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Фулфилмент от маркетплейса: Магазины и пункты самовывоза: Выбранный пункт самовывоза не отображался на детальной странице заказа. Исправлено.

[!] Multi-Vendor Ultimate: Страницы: Витрины: Принадлежащие продавцу страницы отображались на витрине, которая ему недоступна. Исправлено.

[!] Multi-Vendor Utimate: Управление заказами: Витрины: Продавцы могли привязать заказ витрине, которая была им недоступна. Исправлено.

[!] Multi-Vendor: Email уведомления: В письмах о новых продавцах не работала ссылка на детальную страницу продавца. Исправлено.

[!] Multi-Vendor: Витрины: Панель продавца: Происходил некорректный переход на витрину через нижнее меню панели продавца. Исправлено

[!] Multi-Vendor: Категории: Расширенный выбор категории: Расширенный список категорий отображал недоступные продавцу категории при создании и редактировании товара. Исправлено.

[!] Multi-Vendor: Логотипы: Продавцы: При создании продавца через административную панель ему присваивался логотип последней редактированной витрины. Исправлено.

[!] Multi-Vendor: Мастер настройки маркетплейса: Местоположение продавцов: Не включалась настройка "Позволить продавцам выбирать местоположение на Google Картах". Исправлено.

[!] Multi-Vendor: Модули: PayPal Commerce Platform: Платежи через Stripe Connect: Бухгалтерский учет: Баланс продавца не учитывал возврат средств со счета PayPal Commerce Platform или Stripe Connect, из-за чего продавец оставался должен маркетплейсу. Исправлено.

[!] Multi-Vendor: Модули: Конфигуратор панели продавцов:  Привилегии продавцов: Из-за недостаточных привилегий у продавца администратор не мог редактировать панель продавца. Исправлено.

[!] Multi-Vendor: Модули: Лендинги из Тильды: Продавцы: Просмотр страниц Тильды на витрине был не доступен учётным записям администраторов продавцов. Исправлено.

[!] Multi-Vendor: Модули: Местоположение продавцов [Beta]: Общие товары для продавцов: В некоторых случаях фильтры для общих товаров работали некорректно. Исправлено.

[!] Multi-Vendor: Модули: Общие товары для продавцов: В некоторых случаях, на странице общего товара неправильно отображались скидки по промо-акции. Исправлено.

[!] Multi-Vendor: Модули: Оплата напрямую продавцам: Модуль мог вызывать PHP fatal error в сторонних темах и модулях. Исправлено.

[!] Multi-Vendor: Модули: Платежи через Stripe Connect: Возникала ошибка при размещении заказа с выбранным Норвежским языком на витрине. Исправлено.

[!] Multi-Vendor: Модули: Платежи через Stripe Connect: После оплаты способами с "отложенными уведомлениями", такими как SEPA, Sofort и др., средства не переводились продавцу. Исправлено.

[!] Multi-Vendor: Модули: Платежи через Stripe Connect: При использовании валют с нулевым числом знаков после запятой в Stripe отправлялась некорректная сумма заказа. Исправлено.

[!] Multi-Vendor: Модули: Платежи через Stripe Connect: Промоакции: После возврата заказа, в котором использовались промоакции, через Stripe баланс продавца рассчитывался некорректно. Исправлено.

[!] Multi-Vendor: Модули: Премодерация данных продавцов: Общие товары для продавцов: Можно было сделать общим товар, не одобренный администратором. Исправлено.

[!] Multi-Vendor: Модули: Тарифные планы для продавцов: Панель продавца: Описание плана продавца отображалось некорректно. Исправлено.

[!] Multi-Vendor: Модули: Экспорт в Яндекс Маркет: Была возможность выгрузить товары продавца на недоступной витрине. Исправлено.

[!] Multi-Vendor: Модули: Экспорт в Яндекс.Маркет: Генерация с включённой опцией "Экспорт общих товаров" могла прекращаться с ошибкой. Исправлено.

[!] Multi-Vendor: Панель продавца: Не отображалась иконка закрытия всплывающего окна в мобильной верстке. Исправлено

[!] Multi-Vendor: Товары: В выпадающем списке выбора продавцов не работала загрузка данных при скролле. Исправлено.

[!] UI / UX: Товары: Обновить товары: Выбор категорий отображался некорректно. Исправлено.

[!] Витрины: Регионы: Страницы витрины с региональным редиректом могли не индексироваться поисковыми роботами. Исправлено

[!] Детектор изменений ядра: Возникала PHP ошибка при наличии изменений в базе данных в версиях PHP выше 7.2. Исправлено.

[!] Дизайн: Промо-акции: В условии промоакции, в поле выбора варианта характеристики товара, вводимый текст был частично не виден. Исправлено.

[!] Дизайн: Характеристики: Бренды: Крупный текст в описании имел маленький межстрочный интервал. Исправлено.

[!] Документы: URL-адрес витрины всегда отображался с HTTP протоколом в переменной c.storefront_url. Исправлено.

[!] Заказы: Поиск: В панели администратора не удавалось найти заказы в статусе Незавершенный по идентификатору заказа. Исправлено.

[!] Заказы: В некоторых случаях могли создаваться несколько заказов с одинаковыми идентификаторами. Исправлено.

[!] Импорт: В некоторых случаях, отдельные характеристики могли быть пропущены при импорте. Исправлено.

[!] Макеты: При смене макета на страницах товара и сайта отображалась ошибка. Исправлено.

[!] Мобильное приложение: Иконка входа с помощью Apple ID была слишком маленькая. Исправлено.

[!] Мобильное приложение: Некоторые элементы интерфейса работали некорректно в режиме RTL. Исправлено.

[!] Мобильное приложение: Отзывы о товарах: Сообщения ошибки при добавлении отзыва нельзя было изменить. Исправлено.

[!] Мобильное приложение: Отсутствовало оповещение о том, что количество товара в корзине было уменьшено до количества товара в наличии. Исправлено.

[!] Мобильное приложение: При восстановлении пароля был некорректный переход на страницу. Исправлено.

[!] Модули: АТОЛ Онлайн: Для товара и доставки передавался некорректный признак предмета расчета. Исправлено.

[!] Модули:  Google reCAPTCHA: GDPR: reCAPTCHA не работала и после согласия на принятие cookies. Исправлено.

[!] Модули: "Деловые Линии" — транспортная компания: Возникала ошибка при расчете стоимости доставки в Сергиев Посад. Исправлено.

[!] Модули: CommerceML:  При повторном импорте товарам могли быть не назначены удаленные категории, если файл импорта был разделен на несколько частей. Исправлено.

[!] Модули: CommerceML: В редких случаях, импорт мог обновлять другой импортированный товар. Исправлено.

[!] Модули: CommerceML: Магазины и пункты самовывоза: В некоторых случаях информация о пунктах самовывоза переставала отображаться в заказе после синхронизации. Исправлено.

[!] Модули: CommerceML: Процесс импорта мог выполнятся бесконечно долго. Исправлено.

[!] Модули: CommerceML: В редких случаях, импорт мог обновлять другой импортированный товар. Исправлено.

[!] Модули: Google reCAPTCHA: Не было возможности включить reCAPTCHA для формы подписки модуля Email-маркетинг. Исправлено.

[!] Multi-Vendor: Модули: PayPal Commerce Platform: Платежи через Stripe Connect: Бухгалтерский учет: Баланс продавца не учитывал возврат средств со счета PayPal Commerce Platform или Stripe Connect, из-за чего продавец оставался должен маркетплейсу. Исправлено.

[!] Модули: Вариации товаров: В некоторых случаях, модуль мог некорректно модифицировать SQL запрос, что приводило к ошибке. Исправлено.

[!] Модули: Вариации товаров: Выключенные вариации отображались на витрине и были доступны для добавления в корзину. Исправлено.

[!] Модули: Вариации товаров: Не менялся URL товара при выборе характеристики. Исправлено.

[!] Модули: Вариации товаров: Расширенный импорт товаров: Характеристики: Для выключенной характеристики можно было создать вариации. Исправлено.

[!] Модули: Вариации товаров: Социальные кнопки: При переключении варации социальные кнопки пропадали. Исправлено.

[!] Модули: Возврат товаров: Информация о возврате товара исчезала из панели администратора по истечении срока периода возврата для товара. Исправлено.

[!] Модули: Вход через соцсети: Возникала ошибка при аутентификации через Twitter. Исправлено.

[!] Модули: Города: Города не сохранялись в регионе, если в коде региона более 9 символов. Исправлено.

[!] Multi-Vendor: Модули: Зависимости для способов оплаты: Панель продавца: При создании нового способа доставки продавец мог использовать выключенные способы оплаты. Исправлено.

[!] Модули: Карты и геолокация: При загрузке Google карт в консоле показывалось предупреждение о необходимости функции. Исправлено.

[!] Модули: Карты и геолокация: Яндекс Карты возвращали название населенного пункта с типом. Исправлено.

[!] Модули: Магазины и пункты самовывоза: Карты и геолокация: Способ доставки "Самовывоз" по-умолчанию не отображался отдельно на странице товара. Исправлено.

[!] Модули: Мобильное приложение: В некоторых случаях баннер с предложением установить приложение мог не отображаться. Исправлено.

[!] Модули: Мобильное приложение: В некоторых случаях баннер с предложением установить приложение мог отображаться дважды. Исправлено.

[!] Модули: Мобильное приложение: Языки: Товары и характеристики не отображались для продавца на выбранном языке. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Местоположение продавцов: Общие товары отображались во всех категориях. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Опции товаров: Настройка "Быстрая покупка одного из предложений" некорректно работала с опциями товара. Исправлено.

[!] Модули: Отзывы о товарах: Не работал фильтр по рейтингу. Исправлено.

[!] Multi-Vendor Plus: Модули: Привилегии для продавцов: Продавцы имели возможность изменять статусы отгрузок несмотря на ограничения групп пользователей. Исправлено.

[!] Модули: Рассылки: Автоответчику можно было задать статус "Отправлено", что приводило к отправке пустых писем. Исправлено.

[!] Модули: Расширенный импорт товаров : Экспорт/Импорт: Импорт описания товара форматированного в HTML,  добавляло <br /> тег ко всем переносам строк. Исправлено.

[!] Модули: Расширенный импорт товаров: При изменении значения наименования пресета импорта, значение сохранялось только для одного языка - выбранного ранее языка описания страницы. Исправлено.

[!] Модули: Расширенный импорт товаров: Центр сообщений: Отображалась ошибка при вызове "Связаться с администратором" на странице пресета. Исправлено.

[!] Модули: Служба доставки — СДЭК: Заявка на вызов курьера не формировалась на стороне СДЭКа. Исправлено.

[!] Модули: Тарифные планы для продавцов: Вариации товаров: Ограничение на количество товаров не влияло на создание новых вариаций как отдельных товаров. Исправлено.

[!] Модули: Тинькофф [Beta]: Тинькофф Сплитование [Beta]: В некоторых случаях, номер телефона передавался в чеки в некорректном формате. Исправлено.

[!] Модули: Тинькофф [Beta]: Тинькофф Сплитование [Beta]: Многократно отправлялись HTTP-нотификации от банка. Исправлено.

[!] Модули: Тинькофф Сплитование [Beta]: При включённом модуле продавцам было невозможно сменить логотип. Исправлено

[!] Модули: Цена за единицу: Опции: Цена за единицу товара всегда отображалась в зависимости от цены первой опции товара. Исправлено.

[!] Настройки: Товары: Глобальная настройка "Отслеживать количество" в некоторых случаях не учитывалась для списка товаров. Исправлено.

[!] Незавершенные покупки: Если в качестве разделителя тысяч валюты был установлен пробел, то значение итого могло переносится на новую строку. Исправлено.

[!] Онбординг: Пропорции видео могли быть нарушены. Исправлено.

[!] Отчеты о продажах: На некоторых масштабах не подгружались товары в отчетах. Исправлено.

[!] Оформление заказа: Поля профиля: В браузере Safari сообщение об ошибке поля телефона могло быть некорректное. Исправлено.

[!] Оформление заказа: Поля профиля: Введенное значение поля "телефон" сбрасывалось при перезагрузке страницы в некоторых случаях. Исправлено.

[!] Оформление заказа: Промо-акции и скидки: На странице оформления заказа в блоке "Сумма заказа" не отображалась скидка на товар. Исправлено.

[!] Оформление заказа: Способы доставки: В некоторых случаях метод доставки мог не показываться, если лимит веса и вес товара были заданы с тремя знаками после запятой. Исправлено.

[!] Способы оплаты: PayPal Payments: Payflow: В запросе отображалось неверное значение имени. Исправлено.

[!] Товары: Опции: При клонировании варианта опции альтернативный текст изображения клонировался некорректно. Исправлено.

[!] Товары: Страница товаров без категории открывалась с ошибкой. Исправлено.

[!] Товары: Характеристики: Редактировать выбранные: Выбор характеристик был не активен во время загрузки страницы. Исправлено.

[!] Управление заказами: В некоторых случаях, при добавлении товара в заказ возникала ошибка на PHP 8. Исправлено.

[!] Фильтры: Способы оплаты: После удаления фильтров и методов оплаты не сбрасывался счетчик выделенных объектов. Исправлено.

[!] Характеристики: Категории: Не учитывался выбранный язык при редактировании характеристик и категорий, если во второй вкладке браузера открыта страница с выбранным другим языком. Исправлено.

[!] Центр обновлений: На серверах с отключенным типом таблиц "MyISAM" обновления могли прерываться с ошибкой. Исправлено.

[!] Центр обновлений: Обновление платформы CS-Cart могло оказаться внизу в списке обновлений. Исправлено.

[!] Центр обновлений: При обновлении модулей в консоли подставлялся 0 к номеру выбранного модуля. Исправлено.

[!] Центр обновлений: Языки: Шаг обновления языков мог занимать слишком много времени в процессе обновления магазина. Исправлено.
