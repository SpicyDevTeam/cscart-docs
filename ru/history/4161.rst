******
4.16.1
******

==================================
Новая функциональность и улучшения
==================================

[+] Дизайн: Добавлено массовое редактирование товаров на планшетах с маленьким экраном.

[+] Мобильное приложение: Добавлена поддержка Stripe и Stripe connect для оплаты картой.

[+] Модули: Tinkoff [Beta]: Добавлен новый модуль для приема платежей с помощью Тинькофф.

[+] Модули: Tinkoff [Beta]: Добавлена возможность отправить чек при оплате заказа (54-ФЗ).

[+] Multi-Vendor: Дизайн: Панель продавца: Пункт "Информация о продавце" был добавлен для меню пользователя.

[+] Multi-Vendor: Модули: Платежи через Stripe Connect: В описание вывода средств добавлена информация о комиссии Stripe.

=========================================
Изменения в существующей функциональности
=========================================

[*] База данных: Улучшена поддержка InnoDB таблиц.

[*] Дизайн: Блоки: HTML блок с поддержкой Smarty заменен на новый более безопасный блок с таким же названием.

[*] Модули: CommerceML: Производительность: Значительно ускорен импорт файла import.xml с большим количеством вариантов характеристик у товаров.

[*] Модули: CommerceML: У нового модуля CommerceML убрана пометка "Бета". Старый модуль CommerceML помечен как устаревший, и теперь его нельзя установить в новых установках "CS-Cart для маркетплейсов".

[*] Секция помощи: Внешний вид секции помощи был обновлен.

[*] Центр уведомлений: Мобильный режим: Центр уведомлений был адаптирован для отображения на мобильных устройствах.

[*] Ядро: Javascript: Безопасность: Библиотека jQuery UI была обновлена до версии 1.13.2.

==================
Исправления ошибок
==================

[!] Валюты: Альтернативная валюта не отображалась в Email-уведомлении после оформления заказа. Исправлено.

[!] Валюты: Курсы валют онлайн: Иногда не отображались курсы валют. Исправлено; Добавлена возможность использовать свой API-ключ для получения курса валют.

[!] Выбор периода: При определенных условиях выбор периода "Текущая неделя", "Вчера", "Последние 24 часа" и "Предыдущая неделя" работали некорректно. Исправлено.

[!] Дебагер: Кнопка закрытия режима отладки отображалась некорректно. Исправлено.

[!] Дизайн: Frontend: W3C: W3C CSS валидатор обнаруживал ошибки. Исправлено.

[!] Дизайн: В некоторых случаях один заголовок мог отображаться у разных блоков. Исправлено.

[!] Дизайн: Всплывающие окна: Если закрыть всплывающее окно во время выполнения AJAX-запроса, то могла возникнуть ошибка. Исправлено.

[!] Дизайн: Панель администратора: В меню шапки панели администратора некорректно отображались подменю. Исправлено.

[!] Дизайн: Панель администратора: Загрузчик файлов отображался некорректно. Исправлено.

[!] Дизайн: Промо-текст: На странице товара промо-текст мог смещаться. Исправлено.

[!] Дизайн: Шрифты: При сохранении шрифтов могла возникнуть ошибка. Исправлено.

[!] Документы: Email уведомления: Предпросмотр шаблонов для уведомлений статусов заказов вызывал ошибку. Исправлено.

[!] Заказы: Отчеты о продажах: При включенном формате отображения альтернативной валюты "Показывать цены в валюте по умолчанию и в выбранной валюте" отчеты о продажах отображались некорректно. Исправлено.

[!] Заказы: При оформлении заказа в базу данных сохранялись все доступные пункты выдачи заказа. Исправлено.

[!] Модули: CommerceML (1С, МойСклад, Бизнес.Ру) [Beta]: Информация о доставке не импортировалась из "значений реквизитов". Исправлено.

[!] Модули: CommerceML (1С, МойСклад, Бизнес.Ру) [Beta]: При синхронизации обнулялась цена товаров. Исправлено.

[!] Модули: CommerceML: Отсутствовала языковая переменная для статуса импорта N. Исправлено.

[!] Модули: PayPal Checkout: Возникала ошибка на странице редактирования заказа. Исправлено.

[!] Модули: SEO:  PHP Warning мог возникнуть во время установки. Исправлено.

[!] Модули: SEO: SEO-имя могло формироваться с запрещённым символом точки. Исправлено

[!] Модули: SEO: Карты и геолокация: Иногда мог появляться PHP Notice. Исправлено.

[!] Модули: SEO: При выключенном или недоступном текущем языке не производился редирект на витрине. Исправлено.

[!] Модули: Вариации товаров: Блоки: Блок "Список вариаций" не учитывал настройку "Показывать только товары в наличии". Исправлено.

[!] Модули: Вариации товаров: Вариации были недоступными, если товар был доступен для предзаказа. Исправлено.

[!] Модули: Вариации товаров: Вариации, которых нет в наличии, могли быть скрыты на витрине при включенной настройке "Показывать товары, которых нет в наличии". Исправлено.

[!] Модули: Возврат товаров: При обновлении товаров через импорт использовались настройки возврата товара по умолчанию. Исправлено.

[!] Модули: Возникал PHP Notice при удалении уже удаленного модуля. Исправлено.

[!] Модули: Города: Служба доставки — СДЭК: Удален город "5663234234".

[!] Модули: Карты и геолокация: Требуемые товары: Появлялось уведомление о добавлении обязательных товаров в корзину при просмотре товара. Исправлено.

[!] Модули: Комплекты товаров: Вариации товаров: Для вариаций на основе одного товара нельзя было повторно выбрать характеристику в комплекте товаров. Исправлено.

[!] Модули: Комплекты товаров: Детальная страница заказа могла открываться с ошибкой. Исправлено.

[!] Модули: Комплекты товаров: Настройка "Показывать на странице товара" работала некорректно. Исправлено.

[!] Модули: Комплекты товаров: Один из товаров комплекта отображался со скидкой, несмотря на то, что цена товара не менялась. Исправлено.

[!] Модули: Лендинги из Тильды: CSS стили темы могли влиять на внешний вид страницы из Тильды. Исправлено.

[!] Модули: Лендинги из Тильды: Автоматическая синхронизация не работала. Исправлено.

[!] Модули: Лендинги из Тильды: Дополнительные шрифты не загружались. Исправлено.

[!] Модули: Отзывы и комментарии: Была некорректная ссылка на настройки модуля. Исправлено.

[!] Модули: Отложенные товары: Сбрасывался список отложенных товаров при авторизации на витрине через панель администратора. Исправлено.

[!] Модули: Подарочные сертификаты: Сертификаты не удалялись из корзины. Исправлено.

[!] Модули: Расширенный импорт товаров: Импорт/Экспорт: При импорте описания товара с переносом строк переносы не импортировались. Исправлено.

[!] Модули: Соответствие GDPR: При включении модуля некорректно обновлялась конфигурация. Исправлено.

[!] Модули: Соответствие GDPR: В соглашении отсутствовали куки для PayPal Commerce Platform и PayPal Checkout. Исправлено.

[!] Модули: Соответствие GDPR: Не отображалось значение языковых переменных gdpr.uk_cookies_law and gdpr.klaro_ok. Исправлено.

[!] Модули: Соответствие GDPR: Текст языковой переменной gdpr.uk_cookies_law отображался с запозданием. Исправлено.

[!] Модули: Цена за единицу: При включенной настройке "Прятать цену и кнопку добавления товара в корзину", отображалась цена за единицу. Исправлено.

[!] Модули: Экспорт в Яндекс.Маркет: Дата генерации прайс листа фиксировалась в некорректном формате. Исправлено.

[!] Налоги: Заказы: Стоимость способа доставки отображалась без налога в панели администратора, если включена настройка "Отображать цены с налогами на страницах корзины/оформления заказа" и если метод расчета налогов основан на цене за единицу. Исправлено.

[!] Настройки: Внешний вид: Часовой пояс: Неправильно определялось время для часового пояса "(GMT+03:00) Хельсинки, Киев, Рига, София, Таллин, Вильнюс". Исправлено.

[!] Незавершенные покупки: Страна и область доставки могли не отображаться. Исправлено.

[!] Опции товара: При настройке "Если отсутствуют варианты: Скрыть опцию полностью" и отсутствии вариантов, комментарий опции все равно отображался. Исправлено.

[!] Отгрузки: Вкладка отслеживания доставки не отображалась на витрине при наличии одной отгрузки. Исправлено.

[!] Оформление заказа: Поля профиля: При редактировании профиля при оформлении заказа удалялись значения пользовательских полей профиля. Исправлено.

[!] Поля профиля: Вместо обязательного значения можно было использовать пробел. Исправлено.

[!] Поля профиля: Оформление заказа: На форме создания/изменения данных профиля отображались все поля, вне зависимости от настроек полей профиля. Исправлено.

[!] Промо-акции и скидки: Промо-акции для корзины применялись к пустой корзине. Исправлено.

[!] Профили: Отличался параметр столбца города доставки в таблице профилей пользователей. Исправлено.

[!] Редактирование заказа: Символ валюты иногда некорректно отображался в поле ввода. Исправлено.

[!] Товары: Быстрый просмотр: Кнопки "Отложить" и "Добавить в список сравнения" отображались некорректно для Responsive:Black стиля. Исправлено.

[!] Уведомления: В уведомлении об уменьшении количества товара в корзине до максимально доступного не указывалось количество. Исправлено.

[!] Ядро: Изображения формата WebP при загрузке теряли прозрачность. Исправлено.

[!] Ядро: Некоторые заголовки, относящиеся к IP-адресу, некорректно обрабатывались, что приводило к неправильному определению IP-адреса пользователя. Исправлено.

[!] Ядро: Платежи: Выводилось неверное сообщение об ошибке при заполнении данных кредитной карты в шаблоне сс.tpl. Исправлено.

[!] Multi-Vendor Ultimate: API: Продавцы: В ответе на GET запрос к сущности продавцов/витрин с указанием ID могло отсутствовать большое количество базовых полей. Исправлено.

[!] Multi-Vendor: Заказы: Управление заказами: Email уведомления: Не отправлялись уведомления при создании заказа с товарами нескольких продавцов в панели администратора. Исправлено.

[!] Multi-Vendor: Модули: Конфигуратор панели продавцов: SEO: Вкладка SEO была недоступна продавцам. Исправлено.

[!] Multi-Vendor: Модули: Конфигуратор панели продавцов: Некорректно выделялся активный элемент меню. Исправлено.

[!] Multi-Vendor: Модули: Магазины и пункты самовывоза: Продавец не мог сохранить изменения на списке магазинов и ПВЗ. Исправлено.

[!] Multi-Vendor: Модули: Местоположение продавцов: Вместо всех продавцов отображались только те продавцы, которые отображались на странице. Исправлено.

[!] Milti-Vendor: Модули: Местоположение продавцов: Товары не фильтровались по почтовому индексу местоположения продавцов. Исправлено.

[!] Multi-Vendor: Модули: Соответствие GDPR: Местоположение продавцов: Не работало определение местоположения после принятия кук. Исправлено.

[!] Multi-Vendor: Тарифные планы для продавцов: Экспорт/импорт: При выполнении импорта продавцом могли пропускаться товары без категории. Исправлено

[!] Multi-Vendor Plus: Модули: Карта сайта для Yandex и Google: Общие товары для продавцов: Для товарных предложений формировались некорректные ссылки в карте сайта. Исправлено.

[!] Multi-Vendor Plus: Модули: Общие товары для продавцов: Карта сайта для Yandex и Google: Общий товар мог оказаться в карте сайта без доступных предложений продавцов. Исправлено.

[!] Multi-Vendor Plus: Модули: Оплата напрямую продавцам: Заказы: При создании заказа из панели администратора с первого раза товар не добавлялся. Исправлено.

[!] Multi-Vendor Plus: Общие товары для продавцов: Фильтры: В фильтре по продавцам могли отображаться отключённые продавцы. Исправлено.

[!] Multi-Vendor Ultimate: Модули: Склады: Общие товары для продавцов: При использовании склада количество общего товара не синхронизировалось с количеством его предложения. Исправлено.

[!] Multi-Vendor Ultimate: Категории: На детальной странице категории отсутствовал переключатель витрины. Исправлено.

[!] REST API: Заказы: Создание заказа не учитывало оптовую скидку. Исправлено.

[!] UI/UX: Кнопки действий на странице поиска отображались некорректно. Исправлено.

[!] UI/UX: Фильтры товаров: Если название фильтра было слишком длинным, то кнопка сворачивания блока отображалась некорректно. Исправлено.

[!] Ultimate: Дизайн: Значок шестеренки в списке витрин был серого цвета. Исправлено.

[!] Ultimate: Модули: Подарочные сертификаты: Склады: Возникала ошибка на странице заказа в панели администратора, если заказ состоял из подарочного сертификата. Исправлено.

[!] Ultimate: Модули: При ручной перезагрузке настроек и языковых переменных модуля сбрасывались настройки этого модуля для витрин. Исправлено.

[!] Ultimate: Модули: Экспорт в Яндекс.Маркет: При включенном модуле не сохранялись категории в режиме "Все витрины". Исправлено.

[!] Ultimate: После обновления в таблице "user_session_products" использовался некорректный первичный ключ. Исправлено.

[!] Ultimate: Экспорт/Импорт: Заказы: Отсутствовала возможность экспортировать заказы на сервер с одной из витрин. Исправлено.